# --- COMANDI DA LANCIARE MANUALMENTE NEL NODO DNS-SERVER ---

# 1. Vai nella cartella
cd /etc/bind

# 2. Genera le chiavi (Slide 117-120)
dnssec-keygen -a ECDSAP384SHA384 -n ZONE nsdcourse.xyz
dnssec-keygen -f KSK -a ECDSAP384SHA384 -n ZONE nsdcourse.xyz

# 3. Includi le chiavi nel file di zona (Slide 121)
for key in Knsdcourse.xyz*.key; do echo "\$INCLUDE $key" >> db.nsdcourse.xyz; done

# 4. Firma la zona (crea il file .signed) (Slide 122)
dnssec-signzone -A -3 $(head -c 1000 /dev/random | sha1sum | cut -b 1-16) -N INCREMENT -o nsdcourse.xyz -t db.nsdcourse.xyz

# 5. Correggi i permessi (IMPORTANTE)
chown -R bind:bind /etc/bind

# 6. Avvia tutto
service apache2 start
service named restart
